<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Vaxel S.A. - Gestión de Inventario</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Eliminado ZXing, ahora solo usamos html5-qrcode -->
    <script src="https://unpkg.com/papaparse@5.3.0/papaparse.min.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAV4g9ctk9_LzYmGr5ETClPUkZWVSBpkZk",
            authDomain: "stock-a31b8.firebaseapp.com",
            databaseURL: "https://stock-a31b8-default-rtdb.firebaseio.com",
            projectId: "stock-a31b8",
            storageBucket: "stock-a31b8.firebasestorage.app",
            messagingSenderId: "586438978060",
            appId: "1:586438978060:web:148e66263c61656c071c29",
            measurementId: "G-W6E4215CQ4"
        };

        if (firebaseConfig && typeof firebase !== 'undefined') {
            try {
                firebase.initializeApp(firebaseConfig);
            } catch (e) {
                console.warn('firebase.initializeApp error (posible re-inicialización):', e);
            }
        } else {
            console.warn('Firebase no disponible (scripts no cargados o firebaseConfig ausente).');
        }
    </script>

</head>

<body>
    <header>
        <button id="menu-btn" class="icon-btn"><span class="material-icons">menu</span></button>
        <h1>Vaxel S.A.</h1>
    </header>

    <aside id="side-menu">
        <button id="close-menu-btn" class="icon-btn"><span class="material-icons">close</span></button>
        <h2>Configuración</h2>
        <div class="menu-section">
            <h3>Cargar Catálogo de Productos</h3>
            <p>El catálogo se carga desde GitHub al iniciar la app.</p>
            <button id="load-file-btn" class="btn">Recargar Catálogo desde GitHub</button>
        </div>
        <div class="menu-section">
            <h3>Limpiar Datos</h3>
            <button id="clear-picking-btn" class="btn btn-danger">Limpiar Picking</button>
            <button id="clear-almacen-btn" class="btn btn-danger">Limpiar Almacén</button>
            <button id="clear-movimientos-btn" class="btn btn-danger">Limpiar Movimientos</button>
        </div>
        <div class="menu-section">
            <h3>Opciones</h3>
            <label class="switch-label">
                <input type="checkbox" id="toggle-location-requirement">
                <span class="switch-slider"></span>
                Desactivar requisito de ubicaciones
            </label>
        </div>
        <div class="menu-section">
            <h3>Estado Firebase</h3>
            <p id="firebase-status">Verificando...</p>
        </div>
    </aside>

    <main>
        <!-- ... se mantiene igual que antes (Picking, Almacén, Movimientos) ... -->
    </main>

    <!-- Modal del escáner -->
    <div id="scanner-modal" class="modal">
        <div class="modal-content">
            <div id="scanner-container"></div>
            <button id="stop-scanner-btn" class="btn btn-danger"><span class="material-icons">close</span> Detener Escáner</button>
        </div>
    </div>

    <footer id="nav-bar">
        <button class="nav-btn active" data-tab="picking-tab"><span class="material-icons">inventory</span><span>Picking</span></button>
        <button class="nav-btn" data-tab="almacen-tab"><span class="material-icons">storage</span><span>Almacén</span></button>
        <button class="nav-btn" data-tab="movimientos-tab"><span class="material-icons">swap_horiz</span><span>Movimientos</span></button>
    </footer>

    <!-- Nuevo escáner -->
    <script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
